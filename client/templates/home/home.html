<template name="home">
    {{#if currentClub}}
        <div class="row">
            <section class="col-lg-6">
                {{> calendarPanel}}
            </section>
            <section class="col-lg-6">
                {{> notificationPanel}}
                {{> messagePanel}}
                {{> taskPanel}}
            </section>
        </div>
    {{/if}}
</template>

<template name="notificationPanel">
    <div class="box box-info">
        <div class="box-header with-border">
            <i class="fa fa-bell-o"></i>
            <h3 class="box-title">Notifications ({{notificationCount}})</h3>
            <div class="box-tools pull-right">
            </div>
        </div>
        {{#if notificationCount}}
            <div class="box-body">
                <div class="table-responsive">
                    <table class="table no-margin">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Created</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                        {{#each notifications}}
                            {{#if equals type "meeting"}}
                                <tr>
                                    <td><a href="#" data-toggle="modal" data-target="#eventModal">Meeting - {{meeting.meeting.title}}</a></td>
                                    <td>{{formatDateFromNow createdOn}}</td>
                                    <td><i class="fa fa-trash-o notification-delete"></i></td>
                                </tr>
                                <!--{{> eventViewModal meeting}}-->
                            {{/if}}
                        {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        {{/if}}
    </div>
</template>

<template name="messagePanel">
    <div class="box box-success">
        <div class="box-header with-border">
            <i class="fa fa-comments-o"></i>
            <h3 class="box-title">Chat ({{messageCount}})</h3>
            <div class="box-tools pull-right">
            </div>
        </div>
        {{#if messageCount}}
            <div class="box-body chat">
                {{#each messages}}
                    <div class="item">
                        <img class="online" src="{{profileThumbnailSrc createdBy}}">
                        <p class="message">
                            <div class="name">
                                <small class="text-muted pull-right">{{#if ownMessage}}<a href="#" class="delete-message"><i class="fa fa-trash-o"></i></a> | {{/if}}<i class="fa fa-clock-o"></i> {{formatDate createdOn}}</small> {{user.profile.fullName}}
                            </div>
                            {{message}}
                        </p>
                    </div>
                {{/each}}
            </div>
        {{/if}}
        <div class="box-footer">
            <form>
                <div class="input-group">
                    <input class="form-control" name="message" placeholder="Type message..."/>
                    <div class="input-group-btn">
                        <button type="submit" class="btn btn-success add-message"><i class="fa fa-plus"></i></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</template>

<template name="taskPanel">
    <div class="box box-warning">
        <div class="box-header with-border">
            <i class="fa fa-flag-o"></i>
            <h3 class="box-title">Tasks ({{taskCountOutstanding}})</h3>
            <div class="box-tools pull-right">
                <div class="hide-completed">Hide Completed Tasks <input type="checkbox" checked="{{hideCompleted}}" /></div>
            </div>
        </div>
        {{#if taskCount}}
            <div class="box-body tasks">
                <ul class="todo-list">
                    {{#each tasks}}
                        <li class="{{taskClass}}">
                            <input type="checkbox" class="task-item" {{checkedIf complete}}/>
                            <span class="text done">{{details}}</span>
                            <small> - {{formatDateFromNow createdOn}}</small>
                            {{#if ownTask}}
                                <div class="tools">
                                    <i class="fa fa-trash-o task-delete"></i>
                                </div>
                            {{/if}}
                        </li>
                    {{/each}}
                </ul>
            </div>
        {{/if}}
        <div class="box-footer">
            <form>
                <div class="input-group">
                    <input class="form-control" name="task" placeholder="Create task..."/>
                    <div class="input-group-btn">
                        <button type="submit" class="btn btn-warning add-task"><i class="fa fa-plus"></i></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</template>

<template name="calendarPanel">
    {{#if showEventModal}}
        {{#if equals showEventType "fixture"}}
            {{> eventFixtureModal}}
        {{/if}}
        {{#if equals showEventType "meeting"}}
            {{> eventMeetingModal}}
        {{/if}}
        {{#if equals showEventType "training"}}
            {{> eventTrainingModal}}
        {{/if}}
    {{/if}}
    <div class="box box-danger">
        <div class="box-header">
            <i class="fa fa-calendar"></i>
            <h3 class="box-title">Calendar</h3>
        </div>
        <div class="box-body no-padding">
            {{> fullcalendar header=headerOptions defaultView='agendaWeek' class="eventCalendar" events=events eventClick=eventClickHandler dayClick=dayClickHandler weekMode='liquid' minTime='08:00:00' maxTime='20:00:00'}}
        </div>
        <div class="box-footer text-black">
        </div>
    </div>
</template>

<template name="eventFixtureModal">
    <div id="eventFixtureModal" class="modal show fade in">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">{{team.name}} V {{fixture.opponent}}</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 col-xs-6">
                            <p>
                                <strong>Meetup : </strong> {{formatDateTime fixture.meetupDateTime}}<br>
                                <strong>Starts : </strong> {{formatDateTime fixture.startDateTime}}<br>
                                {{#if fixture.endDateTime}}
                                    <strong>Ends :</strong> {{formatDateTime fixture.endDateTime}}<br>
                                {{/if}}
                                {{#if fixture.address}}
                                    <strong>Location :</strong> {{fixture.address.line1}}, {{fixture.address.line2}}, {{fixture.address.city}}, {{fixture.address.county}}, {{fixture.address.postCode}}, {{fixture.address.country}}
                                {{else}}
                                    <strong>Location :</strong><br>
                                {{/if}}
                                <strong>Competition :</strong> {{fixture.competition}}<br>
                                <strong>Opponent :</strong> {{fixture.opponent}}<br>
                                <strong>Officials :</strong>{{#each fixture.officialIds}}{{official.fullName}}<br>{{/each}}
                            </p>
                            {{#if fixture.additionalInformation}}
                                <hr>
                                <p>{{fixture.additionalInformation}}</p>
                            {{/if}}
                        </div>
                        <div class="col-md-6 col-xs-6">
                            <h4>Team Selection</h4>
                            <table class="table no-margin">
                                <tbody>
                                {{#each teamSelection.squad}}
                                    <tr>
                                        <td class="col-sm-1">{{this.squadNumber}}</td>
                                        <td class="col-sm-5">
                                            <span class="label label-{{playerStatusClass}}">
                                                {{#if availability}}
                                                    {{availability}}
                                                {{else}}
                                                    Pending
                                                {{/if}}
                                            </span>
                                        </td>
                                        <td class="col-sm-5">{{player.profile.fullName}}</td>
                                    </tr>
                                {{/each}}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    {{#if currentUserInvite}}
                        <div class="btn-group">
                            <button type="button" class="btn btn-{{currentUserStatusClass}} dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                {{#if currentUserInvite.availability}}
                                    {{currentUserInvite.availability}}
                                {{else}}
                                    My Availability
                                {{/if}} <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#" class="accept">Available</a></li>
                                <li><a href="#" class="tenative">Maybe</a></li>
                                <li><a href="#" class="decline">Unavailable</a></li>
                            </ul>
                        </div>
                    {{/if}}
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="eventMeetingModal">
    <div id="eventMeetingModal" class="modal show fade in">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">{{meeting.subject}}</h4>
                </div>
                <div class="modal-body">
                    <p>
                        <strong>Starts : </strong> {{formatDateTime meeting.startDateTime}}<br>
                        <strong>Ends :</strong> {{formatDateTime meeting.endDateTime}}<br>
                        {{#if meeting.address}}
                            <strong>Location :</strong> {{meeting.address.line1}}, {{meeting.address.line2}}, {{meeting.address.city}}, {{meeting.address.county}}, {{meeting.address.postCode}}, {{meeting.address.country}}
                        {{else}}
                            <strong>Location :</strong><br>
                        {{/if}}
                    </p>
                    <hr>
                    <p>{{meeting.details}}</p>
                    <hr>
                    <h4>Attendees</h4>
                    <table class="table no-margin">
                        <tbody>
                            {{#each meeting.attendeeIds}}
                                <tr>
                                    <td class="col-sm-1">
                                        <span class="label label-{{attendeeStatusClass}}">
                                            {{#if availability}}
                                                {{availability}}
                                            {{else}}
                                                Pending
                                            {{/if}}
                                        </span>
                                    </td>
                                    <td>{{attendee.profile.fullName}}</td>
                                </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    {{#if currentUserInvite}}
                        <div class="btn-group">
                            <button type="button" class="btn btn-{{currentUserStatusClass}} dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                {{#if currentUserInvite.availability}}
                                    {{currentUserInvite.availability}}
                                {{else}}
                                    My Availability
                                {{/if}} <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#" class="accept">Accept</a></li>
                                <li><a href="#" class="tenative">Maybe</a></li>
                                <li><a href="#" class="decline">Decline</a></li>
                            </ul>
                        </div>
                    {{/if}}
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="eventTrainingModal">
    <div id="eventTrainingModal" class="modal show fade in">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Training : {{team.name}}</h4>
                </div>
                <div class="modal-body">
                    <p>
                        <strong>Starts :</strong> {{formatDateTime training.startDateTime}}<br>
                        <strong>Ends :</strong> {{formatDateTime training.endDateTime}}<br>
                        {{#if training.address}}
                            <strong>Location :</strong> {{training.address.line1}}, {{training.address.line2}}, {{training.address.city}}, {{training.address.county}}, {{training.address.postCode}}, {{training.address.country}}
                        {{else}}
                            <strong>Location :</strong><br>
                        {{/if}}
                        <strong>Coaches :</strong> {{#each training.coachIds}}{{coach.fullName}}<br>{{/each}}
                    </p>
                    {{#if training.additionalInformation}}
                        <hr>
                        <p>{{training.additionalInformation}}</p>
                    {{/if}}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</template>